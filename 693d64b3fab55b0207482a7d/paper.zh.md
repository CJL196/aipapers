article /'ɑ:tikl/ n. 文章, 冠词, 物品, 物件, 条款, 契约 [计] 信件 Definition: n. nonfictional prose forming an independent part of a publication n. one of a class of artifacts n. a separate section of a legal document (as a statute or contract or will) n. (grammar) a determiner that may indicate the specificity of reference of a noun phrase

# 通过自适应虚拟现实和生物反馈进行沉浸式恐惧症疗法

阿林·莫尔多维安 ${ \bf 1 } _ { \mathbb { D } }$, 奥安娜·米特鲁特 $^ { 1 , * }$, 尼古拉·金加 1, 卡塔林·佩特雷斯库 ${ \bf 1 } _ { \mathbb { D } }$, 弗洛里卡·莫尔多维安 维克多·阿萨维 ${ \bf 1 } _ { \textcircled { \lfloor p \rfloor } }$, 安娜·玛格达莱娜·安赫尔 1 和莉维亚·佩特雷斯库 ${ \mathfrak { 2 } } _ { \oplus }$ 学术编辑：若昂·马塞洛·泰谢拉 收稿日期：2023年7月26日 修稿日期：2023年9月11日 接受日期：2023年9月14日 发表日期：2023年9月16日 1 罗马尼亚布加勒斯特波利特赫尼卡大学自动控制与计算机学院，邮政编码060042； alin.moldoveanu@upb.ro (A.M.)；nicolae.jinga@stud.acs.upb.ro (N.J.)；catalin.petrescu@upb.ro (C.P.)；florica.moldoveanu@upb.ro (F.M.)；victor.asavei@upb.ro (V.A.)；ana.anghel@upb.ro (A.M.A.) 2 罗马尼亚布加勒斯特大学生物学院，邮政编码010014；livia.petrescu@bio.unibuc.ro \* 通讯作者：oana.balan@upb.ro

摘要：恐惧症是一种焦虑障碍，其特点是对特定物体和情境的严重恐惧。近年来，虚拟现实暴露疗法作为一种更安全、更便捷的恐惧症治疗方法应运而生，其成功率与经典疗法（即对刺激的现场暴露）相当。在对现有技术进行广泛研究并研究该领域的最先进技术后，我们在为期两年的项目中开发了PhoVR（通过虚拟现实进行恐惧症治疗）系统，该项目涉及一所技术大学、一所生物学院以及一家具备设计3D应用能力的行业合作伙伴。我们的最终原型包含了针对恐高症、幽闭恐惧症和公共演讲恐惧的场景，用户需要在其中执行游戏化任务并在虚拟现实环境中导航，同时进行生物物理数据采集（皮肤电活动和心率）、自动焦虑水平分类、场景元素中的生物反馈集成、虚拟环境的动态适配以及随时可用的放松技术。控制面板是专为心理治疗师设计的应用程序，用于管理患者的档案和治疗会话。通过对参与者和评估原型的心理治疗师的定性调查获得的反馈验证了该系统，并提供了改进的建议。 关键词：恐惧症；暴露疗法；虚拟现实；生物物理数据；情感分类；自动适配；生物反馈

# 1. 引言

PhoVR系统是一种通过自适应虚拟现实和生物反馈进行沉浸式恐惧症治疗的工具，其目的是通过虚拟现实逐步控制患者在高度真实的3D环境中接触各种恐惧症和焦虑，以达到治疗效果。在治疗过程中，患者可以通过虚拟现实（VR）眼镜进入一个3D世界，并使用控制器进行导航。3D环境包含复杂的场景，包括地形、植被、建筑及其他元素，能够模拟自然或城市环境中的真实场景。3D环境能够自动适应，或由治疗师实时调整。适应的一个组成部分是改变3D环境的难度，即接触恐惧症刺激的程度。这涉及更改3D场景或场景中某些元素的位置。另一个适应3D环境的组成部分是为患者引入一些支持元素（音乐、视频、文本、喜爱的物品或场景），以促进放松，或采用包含放松和自我控制技术的预录音频。在治疗过程中，从患者身上获取生物物理数据（心率和皮肤电活动），以直观的方式在VR中展示，为当前的情绪状态提供生物反馈。该解决方案包括任务和游戏，挑战患者探索虚拟环境并面对他们的恐惧。任务包含必须完成的任务列表。游戏是一种游戏化任务的形式，具有有趣且吸引人的特色，并使用来自视频游戏领域的技术，以提高患者的参与感。

# 2. 恐惧症统计与治疗方法

目前，有13亿人受到各种心理健康障碍的影响，尽管这些障碍可以治疗或预防，但大多数人无法获得有效的护理。焦虑障碍，例如对公众演讲的恐惧、特定恐惧症、创伤后应激障碍（PTSD）、广泛性焦虑障碍和强迫症，影响2.75亿人，并在全球残疾排名中位列第六。患有焦虑障碍的人会对那些几乎没有危险的物体和情境产生恐惧和回避。各国的患病率从2.5%到6.5%不等，尤其在美国、加拿大和北欧地区较高。女性的心理状况更为突出，特别受到抑郁症、焦虑症、饮食障碍和双相情感障碍的影响。COVID-19疫情引起的社会孤立、对感染的恐惧以及对亲人疾病或死亡的忧虑，导致抑郁和焦虑障碍的发生率增加了25%，尤其是在年轻人和女性中。此外，2022年5月猴痘疫情被世界卫生组织宣布为全球公共卫生紧急事件，导致社交网络上有关建议、措施的讨论以及关于该疾病的信息分享活动增加。由于马尔堡病毒在2022年的全球传播及可能引发新疫情，对流行病学家构成了威胁。为了防止这种不良情况，社交媒体可以提升对该疾病及其相关风险的认知。大约13%的全球人口遭受各种恐惧症的困扰，例如社交焦虑症和广场恐惧症，以及对高度、飞行、蜘蛛、蛇、幽闭空间等特定恐惧症。社交恐惧症（在他人面前写东西或吃东西、与权威人士见面、使用电话或在人群中演讲的恐惧）影响各个年龄段的人，但通常在青少年时期出现。成年后，45%的社交恐惧症患者会发展为广场恐惧症和焦虑发作，而17%则会发展为抑郁症。大多数人依赖药物，甚至滥用非法毒品（近17%）或酒精（近19%）。大约15%到20% 的全球人口至少在一生中经历过特定恐惧症。恐高症（发生率为7.5%）、幽闭恐惧症（对狭窄或封闭空间的恐惧）、飞行恐惧症和蛇恐惧症是最常见的特定恐惧症。这些特定恐惧症通常在童年时期开始，并可能持续终生。如果接受治疗，其恢复率仅为20%。

治疗焦虑症的最常见方法包括药物（药丸）和在治疗师指导下进行的认知行为疗法（CBT），这使患者能够通过思维和行为控制以不同的方式看待创伤经历 [8]。暴露疗法的反应率为$80{-}90\%$。它分为面对面（in vivo）、想象中（in sensu）和虚拟（in virtuo）暴露。在虚拟暴露中，治疗使用计算机生成的虚拟环境进行，患者偏好这种方式，因为他们意识到自己面临的仅仅是一个模拟 [9]。虚拟现实暴露疗法（VRET）在现实生活中具有强烈的影响力，并且结果在时间上保持良好，与CBT疗法获得的结果相等，并且在VR和面对面暴露之间的脱落率没有差异。然而，虚拟暴露有时会引发晕动症，因为身体的模拟运动与其他感官信息之间存在不匹配。关于虚拟现实在恐高症治疗中应用的首次研究可以追溯到1990年代，属于Rothbaum [10]。

# 2.1. 商业虚拟现实暴露疗法系统

各种虚拟现实暴露疗法（VRET）系统已经开发并作为商业产品上市，用于治疗多种疾病：C2Care（恐惧症、强迫症、创伤后压力症候群、成瘾（酒精、香烟、赌博等）和饮食失调），Amelia（恐惧症、饮食失调），虚拟现实医疗中心（VRMC）（创伤后压力症候群），Virtually Better（恐惧症、成瘾）以及XRHealth。这些系统允许治疗师进行协调。在C2Care中，治疗师可以增加或减少某些刺激，例如人群的密度、他人的外貌、情感和场景，或在环境中直接与患者对话。在XRHealth中，治疗师可以实时控制和监控患者的虚拟现实会话，并进行必要的实时调整。Amelia允许个性化干预，提供更大的控制权。XRHealth促进个体化治疗，治疗师可以制定个性化护理计划，并根据患者的进展不断更新。C2Care、XRHealth和Amelia均设有管理面板，提供患者在虚拟现实中看到的内容反馈及数据管理门户。

# 2.2. 在学术背景下开发的虚拟现实暴露治疗系统

AcTiVity 系统 [16] 在 42 名未受恐高症影响的参与者中进行测试，用于评估用户的虚拟化身如何影响他们的存在感、沉浸感和运动恶心感。受试者分为两组——有身体虚拟化身和没有身体虚拟化身的表现。结果显示，使用身体虚拟化身的组别存在感更高，因为可以根据身体高度来估计距离，这种方法也适用于具有恐高倾向的受试者。在 Coelho 等人 [17] 提出的恐高症实验中，15 名受试者逐步接触高度（在虚拟和现实环境中），从一栋建筑的一楼到八楼，持续 3 周，由心理医生提供指导和鼓励。数据评估显示，治疗后，两组达到了相同的结果，仅在每次会议的时长上存在差异。在这方面，虚拟现实会议的时间比现实世界会议短 $5 0 \%$。Emmelkamp 等人 [18] 使用了低成本虚拟现实暴露系统进行恐高症治疗和现场治疗。共有 29 名参与实验的受试者需要在 1 到 10 的范围内评价他们的焦虑水平。当治疗师认为患者的焦虑水平已足够低时，将调整暴露的难度。结果显示，患者的焦虑和回避水平均有所降低，得出结论认为虚拟现实暴露治疗至少与现场暴露同样有效。文献 [19] 中展示了一个山区和城市环境。在该研究中，10 名受试者进行了为期两个月的现实世界暴露，另 10 名受试者参与了相同时间的虚拟现实暴露治疗。结果显示，第二组的焦虑水平显著降低，从 $6 4 \%$ 降至 $4 0 \%$。ZeroPhobia [20] 包含六个带有解说声音的动画模块和一个虚拟治疗师；移动 VR 游戏；以及由视线方向控制的 360 度视频。共有 66 名受试者测试了该系统，实验得出的主要结论是 VR 会议的最佳时长应约为 $2 5 ~ \mathrm { m i n }$，因为增加的暴露时间必然提高治疗效率。在文献 [21] 中呈现的实验中，10 名受试者（5 名有恐高症，5 名为对照组）被暴露于一个城市的 3D 虚拟模型中。他们需要穿过两栋建筑之间的一条走道，体验七层建筑屋顶的视角。研究显示，焦虑行为（与基线测量相比，心率至少增加 15 次/分钟）与报告的恐惧水平之间存在正相关关系。在 CAVE（洞穴自动虚拟环境）设备中模拟了一个带有金属结构的丘陵景观，其中央有四个平台位于不同高度 [22]。99 名受试者的实验结果显示，地面和墙面的投影增加了沉浸感和焦虑感，但并未影响存在感。六名恐高症用户进行了三次电子虚拟现实远程会议（从办公室阳台的视角），随后是在治疗师的陪同下进行了三次现场暴露会议 [23]。数据分析显示，在两种条件下（虚拟及现场），主观感知的焦虑水平（通过特定问卷评估）和生理反应（心率测量）之间没有差异。文献 [24] 中展示的 VR 模拟器并非专门用于治疗，而是供希望判断其员工是否患有恐高症的公司使用。虚拟环境中显示一个移动平台和一个位于 $1 1 \mathrm { m }$ 高的杆顶上的虚拟梯子。场景还包括建筑、行驶的汽车、天空和移动的云，增强了存在感。根据文献 [25] 中的实验，患有恐讲话症的人在空旷的交流室和面对具有中立行为的虚拟观众时，比非恐惧者更加紧张。另一方面，观众的敌对态度在演讲者中产生了强烈的情感，不论是自信的演讲者还是恐讲话症患者 [26]。DIVE [27] 虚拟环境用于创建两种场景：一种是友好的观众，另一种是敌对观众。经过对生理测量和演讲表现的数据分析，发现共同存在与虚拟观众的化身态度相关。在文献 [28] 中展示的游戏中，玩家可以修改观众的设置，让他们通过笑声、评论、鼓励或鼓掌与演讲者互动。由八名受试者组成的虚拟现实治疗组在 5 周的治疗后取得了显著改进，而对照组的表现保持不变。在 $1 0 { - } 2 0 \mathrm { m i n }$ 的长时间会议开始时观察到焦虑增加，而在暴露中段则显著下降。在文献 [29] 中使用了一些 360 度虚拟环境，描绘了三个培训场景：一个空教室、一个有小观众的教室和一个有大型观众的教室。由 35 名受试者进行的实验结果显示，焦虑水平下降，特别是对于基线焦虑水平较高的受试者。在另一项研究中，年轻软件工程师被要求在虚拟观众面前关于几个争议性主题进行演讲 [30]。心理治疗师可以操控场景并操纵观众的反应。作者得出结论，持续的治疗在降低焦虑水平方面有效。AwareMe 系统 [31] 包含一个监测语音因素的模块：音调、填充词和说话词汇量。在演讲过程中，手环提供视觉和触觉反馈。在一项大型实验中，记录了 66 名受试者的数据（自我报告的焦虑、心率、心率变异性和唾液皮质醇分泌），分为三种不同设置：真实世界讲座厅中的真实观众、VR 中的满座讲座厅和 VR 中的空讲座厅伴有干扰声。结果显示，在真实世界和 VR 条件下的压力模式相似，并且男女参与者之间没有显著差异。对 PubVR 系统作为公开演讲恐惧治疗工具的评估 [32] 关注患者对与现场控制化身互动与标准预录动画的感知和体验。显著地，24 名健康受试者被分为两组：实验组通过运动追踪摄像头获得来自指挥者的语音和上半身动作输入，而对照组则使用预定义动画和预录陈述。定性分析的结果表明，实验组参与者在接受自发反应和在治疗会议中能够通过后续问题发起对话时感到更舒适。其他观察显示，当没有直接互动时，受试者往往会暂停演讲，导致存在感的中断。

# 3. PhoVR系统

# 3.1. 虚拟现实与生物物理采集设备

PhoVR系统使用市场上容易获得的经济型消费级虚拟现实播放和生物物理采集设备。该系统旨在与一体式设备（如Oculus Quest系列[33]）以及需要由VR兼容笔记本电脑或台式机进行外部处理的头戴式显示器（HMD）设备配合使用。特别是，我们使用了HTC Vive[34]和Valve Index[35]头戴式显示器，这些设备也被推荐使用，但市场上还有其他型号可供选择。为了简化使用和配置，并且因为成本大幅降低，使用仅一体式设备（如Oculus Quest 2）是理想的，但其处理能力远低于台式解决方案。因此，仍然推荐使用专用的头戴式显示器以提升图形质量和实现最佳视频流。在虚拟现实会话期间，我们收集了生物识别数据来评估感知焦虑的程度。我们使用便携式设备记录了皮肤电反应（EDA）和心率变异性（HRV）。经过对市场上可用设备的详细分析，BITalino[36]因其易于使用、增强的人体工程学和降低的成本而被选中。

# 3.2. 虚拟环境描述

# 3.2.1. 教程场景

教程场景是任何新用户的必备场景。它描述了如何在场景中移动，使用哪些控制器按键及其目的，存在哪些类型的任务，以及它们是如何构建的。在游戏关卡中，需要完成一些任务。任务被定义为用户需要执行的动作。任务分为四种类型：

检查点——用户移动到标记点的任务类型。任务成功完成后，会听到确认音。拍照——在该任务中，用户需拍摄某个物体或动物的照片。根据场景的不同，物体或动物可以有所不同。一种场景中，物体是雕像，而在另一种场景中，则是海鸥等。当用户达到目标物体周围区域时，屏幕的外观会部分改变，物体会被描边。如果相机的方向与物体的位置之间的角度不够小，描边将为黄色。用户需要注视该物体以将描边颜色更改为绿色。用户可以通过按下控制器的触发按钮来拍摄照片。• 收集——用户收集三种或以上同类物体的任务类型。收集的物品为蓝色粒子。玩家需要在虚拟现实中朝粒子移动，以便与其发生碰撞（图1）。拾取——在该任务中，用户需要从场景中捡起不同的物体。根据进行的场景，物体或动物各不相同：在一种场景中物体为蜡烛，而在另一场景中则是瓶子等。要将物品放入库存，用户需用右手指向物品并按下控制器的抓取按钮。如果手指向正确，控制器会震动，物体底部会出现一个半透明的圆圈（图2）。在整个场景中，随机时刻会出现一个面板，询问“控制你的情感有多容易？”通过对场景中不同时间点收到的反馈进行平均，分析用户情感状态随时间的演变。收集的数据还用于建立用户主观感知的焦虑程度与使用录制的生物识别数据计算的焦虑程度之间的联系。

![](images/1.jpg)  
Figure 1. Collection task.

![](images/2.jpg)  
Figure 2. Pickup task.

完成一个任务后，下一个任务的评分将会变为可见。任务序列是一系列必须按特定顺序完成的任务。在一个序列中，不能同时有两个活动任务。序列的结束通过展示一个表单来标记，表单中包含以下三个问题（图3）：任务序列有多简单？ • 控制你情绪的难易程度如何？任务序列有多愉快？

![](images/3.jpg)  
Figure 3. Form with assessment questions.

教程场景是一个简单的场景，包含四张桌子。用户最初位于场景中心，可以在3D空间中的面板上找到图像和指令。在每张桌子上都有一个不同的物体，将用于一个任务。用户需要完成一系列任务，包括一个检查点、两个拍照任务、一个收集任务和两个拾取任务。控制器按钮的功能如下：摇杆——通过上下或左右移动摇杆，玩家可以在场景中移动；摇杆按下——打开主菜单，用户可以在其中修改应用程序的多个方面，例如图形质量、音量、移动速度、活动场景等；• A键——将用户向左旋转；• B键——将用户向右旋转；• 触发器——用于选择或确认动作（菜单/任务）；握把——用于物体拾取任务。

# 3.2.2. 高所恐惧症治疗的虚拟环境

对于恐高症治疗，开发了两种自然环境和两种城市环境。第一个自然环境是山地场景。用户被要求沿着一条由两个序列组成的路线行进：在一个大型开放空间区域的自由行走和乘坐缆车。在自由行走中，用户有几种选择：在金属平台上行走（图4）；• 在主脊边缘行走；沿河的下行路线。

![](images/4.jpg)  
Figure 4. Metal platform.

路径使用特殊纹理标记，以确保玩家不会在场景中迷失。轨迹可以从远处观察到。跟踪路线的另一种方法是跟踪活动任务标记。缆车路线（图5）可以向上或向下行驶。缆车覆盖的距离被分为10个大致相等的段落。每个段落由一根杆子标记，缆车将在其旁停靠。当缆车停下来时，用户会被通知有若干任务需要完成和问题需要回答。出于性能原因，该场景不断进行优化。直接在Oculus Quest上运行的应用程序帧率较低，当移动头戴设备时，图像变得卡顿且模糊。因此，在对场景元素进行详细分析后，关卡进行了全面修改。第一个变化是去除了大量树木。场景中最昂贵的元素之一就是树木。它们的数量大幅减少，3D模型被优化为适合手机系统的模型。场景中的第二个复杂元素是地形。其尺寸被缩小，地形最终被转换为3D模型，以降低渲染操作的数量。

![](images/5.jpg)  
Figure 5. Cable car.

第二个自然场景是一个窄小、受限的区域，用户可以在其中自由移动。该场景由两座陡峭的悬崖和一座钢桥构成（见图6）。任务是在悬崖和桥的边缘执行，迫使用户从一座悬崖跳跃到另一座悬崖。为了营造特殊的氛围，使用了各种因素，如低照明、乌鸦群和浓雾（见图7）。

![](images/6.jpg)  
Figure 6. Metal bridge.

![](images/7.jpg)  
Figure 7. Metal bridge covered in fog.

用于治愈恐高症的城市场景中布满了大量建筑物。用户最初位于一栋建筑的露台上，必须到达最高层，即屋顶（见图8）。在场景中存在的所有建筑物中，玩家只能在两栋建筑上行走：他们在场景开始时所在的建筑以及相邻的建筑。这两栋建筑分别分为三个高度层级。电梯用于改变高度层级。

![](images/8.jpg)  
Figure 8. Initial building.

• 第一层——玩家将在一个高度为 $6 6 \mathrm m$ 的平台上行走，相当于17层；• 第二层——高度为 $1 0 8 \mathrm { m }$ ，相当于28层； − 第三层——最后一层是建筑的屋顶，位于 $1 3 1 \mathrm { m }$ 的高度，相当于35层。在建筑的每一层，用户都有一系列任务需要完成。这些任务的位置被选择，以引导用户走向最有效的路径，既测试他们的焦虑水平，又考虑到会话的持续时间。前往建筑的下一层或进入下一座建筑是通过与场景中特定组件的互动来实现的。为了更改建筑的层级，设有一个金属平台作为电梯，配备上下的按钮。如果两个层之间的楼层差距过大，平台将在中途停止。在这个静止点，用户必须完成一个任务才能继续前进。两座建筑之间的移动是通过两座桥梁进行的。一座桥位于两座建筑的第二层之间，另一座桥位于第三层之间。桥由细金属杆构成，地面由格栅组成，受试者可以透过格栅看到地面（见图9）。场景中的第一个任务是一个检查点。用户必须朝着活动标记移动，任务结束时，可以看到下一个任务的位置。在第二个任务中，玩家必须收集三个物体。它们被放置在附着在阳台边缘的金属平台上。该平台由金属杆和格栅构成，用户可以在上面移动。待收集的物体被放置在平台的边缘，尽可能靠近格栅，以迫使用户向下看。收集完这三个物体后，第三个任务的标记被激活。玩家需要拍摄一只坐在金属杆上的海鸥（见图10）。为了足够接近海鸥，在专用拍照区域，玩家必须爬上另一个金属平台。

![](images/9.jpg)  
Figure 9. Metal bridge between the buildings.

![](images/10.jpg)  
Figure 10. Seagull on a metal bar.

整个场景的完整运行大约需要 $10 \mathrm{分钟}$。根据患者的速度、技能和焦虑水平，运行时间可能会增加。第二个城市场景与第一个场景相似，但建筑物有所不同。该场景被划分为三个区域，区域内布满了使用透明材料的元素，从而提高焦虑水平，这些透明材料使玩家能够更容易地感知高度。用户从一栋建筑的一楼开始新的场景，需要利用平台爬升 40 层到达建筑的屋顶。电梯将在两个不同的地点停靠，分别是第 18 层和第 33 层，在这两个层面上有两个摄影任务。第二个区域由薄金属杆和网格地板组成的平台构成。为了创造出更高的高度错觉，桥梁被倾斜到不同的角度（图 11）。

![](images/11.jpg)  
Figure 11. Tilted bridge.

第三个区域的屋顶边缘也附有金属平台。到达这个最后的位置，需要乘电梯并跨越一座桥。场景中包含可以根据患者恐惧程度配置的元素。例如，桥可以进行改造：格栅可以被更换为金属面板，用户将无法看到下面的情况，或者也可以更换为玻璃栏板。金属侧栏可以完全移除，或者更换为更厚的栏杆或不同高度的墙壁。在电梯或附在露台边缘的 платформ 上也可以进行类似的改造。由于性能原因，此场景也进行了改造。树木和建筑物被替换为低多边形的3D模型，以实现更高的帧率，特别是在应用直接运行于头戴设备时。原始建筑物有1200万个顶点，替换后的3D模型顶点数量介于40万到120万之间，但在应用运行时，分辨率的效果并没有太大差别。最后，玩家需要行走的两座建筑物被特别设计，以满足任务需求，顶点数达到了18万到19万个。其他建筑物则被替换为仅有84个顶点的模型。最终场景的帧率为每秒20帧。为了实现更好的性能，应用了许多设置，其中最重要的是遮挡剔除和光照贴图。遮挡剔除是一个避免计算被其他物体完全遮挡的物体渲染的过程。光照贴图是存储预计算的场景光照信息的贴图。这些数据在运行时无法修改。通过排除那些能够实时改变位置的场景光源，提升了整个场景的性能，从而更容易部署到移动系统。

# 3.2.3. 用于幽闭恐惧症治疗的虚拟环境

对于幽闭恐惧症治疗，我们设计了三个暴露场景：一个隧道、一迷宫房间、以及一个洞穴。隧道场景带领用户穿过一个光线昏暗的隧道（图12）。这是一个较短的场景，但环境参数的变化速度较快。这些参数随着用户在场景中的进展而变化：隧道的宽度逐渐减小，天花板的高度变低，照明变得较弱，障碍物变得更加狭窄。

![](images/12.jpg)  
Figure 12. Tunnel scene.

最初设计的场景较为简单。用户需要直线行走并按顺序激活任务。由于冲击力不足，路线中添加了各种障碍物。这些障碍由补充墙壁组成，以限制用户的活动空间。在整个场景中，有一组10个任务序列。在拍照任务中，用户需要拍摄一个雕像。在拾取任务中，用户需收集蜡烛。为提供一个新的曝光场景，设计了一个迷宫式房间（图13），其难度更高。氛围和视觉元素与隧道中的相似，区别在于场景的结构方式。用户在一个大房间内开始场景。他们必须按照任务进行，穿越不同面积的房间。尽管房间的面积逐渐减少，但房间的宽度和长度是随机变化的。

![](images/13.jpg)  
Figure 13. Labyrinth of rooms.

在八个互联的房间中，最后三个房间是最狭窄的。在场景结束时，用户被限制在一个只能容纳一个人的小房间内。洞穴场景（图14）包含四个场景：三个在洞穴不同区域的场景和一个在开放、放松空间的场景。通过从一个场景进展到另一个场景，玩家可以注意到游戏难度水平的增加。最开始洞穴的高度是玩家身高的三倍，但逐渐降低，最终达到1:1的比例。通过这种方式，随着洞穴顶部和地面之间距离的减小，患者情绪的强度会增加。

![](images/14.jpg)  
Figure 14. Cave.

玩家在洞穴的右端起始，任务是寻找前往下一个关卡的传送门。传送门随机放置在洞穴的一端，场景中用一间木屋来表示传送门。玩家需要打开门进入木屋。要进入下一个关卡，必须在关闭门的情况下，在木屋内停留15秒。在路途中，玩家可以收集不同颜色的水晶：蓝色、水红色或白色。为了鼓励探索整个场景，一些水晶被放置在比较难以到达的地方，如群集的钟乳石和石笋后面，玩家需要在其间潜行。收集到的物品数量将用于计算最终游戏得分。场景中还添加了动物（蝙蝠）和特定物体（骷髅或燃烧的木桶）。如果玩家靠近一群蝙蝠，它们会被触发移动。蝙蝠会飞起并再次落在天花板上，距离原位相对较近。

# 3.2.4. 演讲恐惧治疗的虚拟环境

在恐惧症治疗环境中，用户被置于一个虚拟房间内，需进行简短的演讲。用户或治疗师可以配置场景，运行场景，并获取会话中的分析及会后分析。提供三种房间类型和五个房间拥挤度与观众分布的预设。用户和心理治疗师可以实时可视化表现统计数据。用于治疗公众演讲恐惧的环境包含以下功能：√ 场景设置模块（图15）；场景运行模块；• 将用户沉浸在之前选择和配置的场景中；• 在虚拟应用程序内自由发言或演讲主题；监控沉浸因素；实时计算虚拟观众中每个人的注意力程度；每个人在虚拟观众中的注意力程度的数值显示和颜色指示；与计算出的注意力程度相对应的动画效果；会话中的分析；会后分析。

![](images/15.jpg)  
Figure 15. Module for setting up the scene.

场景设置允许用户/心理治疗师选择以下方面：房间类型、观众设置、观众分布和观众的初始行为（见图15）。通过按下初始行为按钮，将打开配置观众初始行为的子菜单，以设置因素和分布类型。三个人格因素为“对主题的兴趣”、“疲劳程度”和“分心程度”。分布类型可以是均匀分布（具有最小和最大参数）或高斯分布（最小、最大和σ参数——或分布高度）。房间类型有三种：• 小房间（面谈室）——最多4个座位；• 中型房间（讲堂）——最多27个座位；• 大房间（圆形剧场）——最多124个座位（见图16）。有五种预定义的房间填充设置。百分比表示生成观众占用的座位数。• 空房间 $( 0 \% )$；• 小型观众 $( 2 5 \% )$；• 平均观众大小 $( 5 0 \% )$；• 大型观众 $( 7 5 \% )$；满房间 $( 1 0 0 \% )$。

![](images/16.jpg)  
Figure 16. Amphitheater.

一个会话需要以下步骤：将用户放置在选择的、之前配置好的场景中；在虚拟现实暴露场景中自由发言或呈现主题（图 17）；

![](images/17.jpg)  
Figure 17. Presentation scene.

在演示过程中，系统监测影响观众兴趣的因素，为每个虚拟个体计算注意力程度（累积得分），以数字和颜色指示器展示该程度，并根据他们的注意力程度进行虚拟观众的动画表现。监测因素分为两类。前面提到的观众因素（对主题的兴趣、疲劳和分心）可以进行初始配置，另一类是用户因素。下面详细描述的用户因素直接影响观众因素。第一组用户因素包含空间因素：• 相对观众的位置—通过测量演讲者与每位观众之间的距离进行计算；• 手部运动—在定义的时间间隔内（例如最后10秒）手部运动轨迹的总长度；• 目光方向—演讲者的视线方向影响观众因素，这取决于观众每个人距离演讲者视野中心的远近。这仅适用于位于注意力角度内的观众。注意力角度以演讲者的目光方向为中心，在虚拟环境中设定了一个预设的视角（例如，60度）。注意力因素根据演讲者目光方向与观众个体方向之间的角度计算（连接演讲者位置与观众位置的线段）（图18）。

![](images/18.jpg)  
Figure 18. Attention angle.

第二组用户因素包括声音因素：声音音量——在会议期间，通过麦克风录制的分贝水平被测量，演讲者需根据所选参数调整音量，以确保观众能够听到其所说内容。此外，如果声音音量出现过大或过于频繁的波动，演讲者的评分将受到不利影响。 语速——在整个会议期间，演讲者说话的词数被测量并平均，以显示每分钟的词数。这是基于使用语音转文本算法生成的词数计算的（转换使用了 Microsoft Azure Services [37]）。 词间停顿——在会议期间，测量演讲者未发言时的时间，即麦克风录制到的无声音的时长。流畅度和单调度的程度是基于各种经验法则进行计算的。基于为每位观众计算的注意力得分以及上述因素，实时向用户呈现的反馈通过以下特征可视化：• 与观众相关的各种动画；数值和颜色编码（可选择显示，并可通过控制器上的按钮激活）。其他结果，如会议时长、当前平均注意力得分、语音转文本算法的结果等，可以以信息性方式显示给用户。用户实时获得关于自己表现的统计数据，例如观众的整体兴趣水平、心率、声音音量和节奏，这些信息会在教室（或任何选定的房间）后方显示，供演讲者在面对观众时可视化。数据以数值形式提供（与各因素相关），并附有简要说明和颜色，以指示用户当前所处的水平—绿色、黄色或红色（图19）。会后分析包括演讲者在会议期间表现的信息：用于评估会议中提到的所有因素的 C 图；与用户参与的之前会议的对比数据（历史/演变）。

![](images/19.jpg)  
Figure 19. Performance statistics in real time.

3.3. 技术与性能评估 为开发虚拟环境，我们使用了以下技术： - Unity 3D [38] — 支持虚拟现实的图形引擎； - SteamVR 插件 [39] — Unity 3D 的扩展； - Adobe Fuse [40] — 用于创建观众的 3D 模型； - Adobe Mixamo [41] — 用于为 3D 模型添加动画的应用程序。通过 Adobe Mixamo，我们渲染了观众的多种状态，例如“感兴趣”或“不感兴趣”； - Microsoft Azure 语音转文本 [42] — 用于分析通过麦克风记录的声音以生成文本的应用程序。文本随后被分析，以获得关于语速和单词间停顿的统计数据。 虚拟环境的性能通过在帧级记录场景的更新和处理时间进行测试。为了保证性能稳定，处理时间应不低于每帧 33 毫秒，这对应于每秒 30 帧的频率。针对恐高症和幽闭恐惧症治疗，3D 环境设计为在 Oculus Quest 2 一体化头戴显示器系统上运行。性能测试在具有以下配置的 Oculus Quest 2 一体化头戴显示器系统上进行： - 处理器 — Qualcomm Snapdragon XR2 7 nm； - 内存 — 6 GB — DDR5； - 显卡 — Adreno $6 5 0 \times 7 \mathrm { n m }$； - 存储 — 256 GB； - 显示刷新率 — $- 7 2 \mathrm { H z } , 9 0 \mathrm { H z } , 1 2 0 \mathrm { H z }$； - 分辨率 — $1 8 3 2 \times 1 9 2 0$（每只眼睛）。 虚拟环境还可以通过 HMD VR 设备在笔记本电脑/台式电脑上运行。进行性能测试的 VR 台式系统具有以下配置： - 处理器 — Ryzen $7 3 , 7 0 0 \times 3 . 6 \mathrm { G H z }$； - 内存 — 32 GB — DDR4 3200 MHz； - 显卡 — 1060 GTX — 6 GB。 性能结果见表 1。

Table 1. Performance results.   

<table><tr><td rowspan="2">Scene</td><td colspan="4">Test Performance (fps)</td></tr><tr><td colspan="2">Oculus Quest 2</td><td colspan="2">Desktop System</td></tr><tr><td></td><td>Minimum Value</td><td>Average Value</td><td>Minimum Value</td><td>Average Value</td></tr><tr><td>Main menu</td><td>60</td><td>72</td><td>74</td><td>119</td></tr><tr><td>Tutorial scene</td><td>55</td><td>60</td><td>71</td><td>120</td></tr><tr><td>Acrophobia—natural environment</td><td>30</td><td>35</td><td>60</td><td>86</td></tr><tr><td>Acrophobia—urban environment</td><td>35</td><td>40</td><td>68</td><td>90</td></tr><tr><td>Claustrophobia—tunnel</td><td>57</td><td>60</td><td>74</td><td>114</td></tr><tr><td>Claustrophobia—cave</td><td>58</td><td>60</td><td>70</td><td>105</td></tr><tr><td>Interview scenario</td><td>-</td><td>-</td><td>87</td><td>115</td></tr><tr><td>Classroom scenario</td><td></td><td></td><td>98</td><td>117</td></tr><tr><td>Amphitheater scenario</td><td></td><td></td><td>64</td><td>91</td></tr></table>

如上表所示，最低和平均性能值足以保证虚拟现实环境的安全运行，不会因视觉信息更新率过低而导致患者出现眩晕状态。Microsoft Azure 语音转文本（或语音识别）能够实时将音频源转录为文本。该服务使用微软的专有数据进行训练，作为云服务提供，运行在微软的服务器上。Azure 语音转文本被集成到公共演讲恐惧症治疗的应用程序中。用户在应用程序中说出的词语通过此平台进行处理。向服务器（云端）发送请求，以获取基于用户说话时生成的音频流的文本。处理过程是实时的，获得的结果是文本，随后会对其进行处理以收集如语速、语言清晰度等统计信息。Azure 语音转文本支持多种语言，而我们应用程序中选择的语言是英语。Azure 语音转文本的性能非常优异，在口语单词检测中准确率超过 98\%。向服务器的请求持续时间最多为一秒，文本分析直至获得最终结果的时间也最多为一秒。综上所述，Azure 语音转文本表现良好，经过测试，它能够跟上用户在应用程序中说出的短语和句子的节奏，以实时提供结果。

# 3.4. 虚拟环境中的生物反馈集成

在治疗会话中，视觉生物反馈直接在头戴设备上提供给患者，同时通过控制面板提供给治疗师。此外，对于自然环境，开发了一种直接集成到环境属性中的视觉生物反馈模块。环境的各种属性可以进行修改。因此，根据心率（HR）和皮肤电反应（EDA）参数，周围光线的颜色、天空的主要颜色以及天空中云层的密度和颜色都会发生变化。在图20的左侧图像中，天空晴朗，没有云，表明用户处于放松状态；中间的较暗天空和云彩则显示用户倾向于感到焦虑，而右侧图像中用户非常焦虑，这种情绪状态通过紫色天空和云彩可视化。基于周围环境变化的模型确保了沉浸感，可能促使患者维持对应于较低焦虑水平的情绪状态。

![](images/20.jpg)  
Figure 20. Biofeedback integrated into the scene's elements.

# 3.5. 发出困难时刻的信号

患者的困难时刻可以以较高的信心被识别。最初的一项策略是使用虚拟治疗师来为患者提供建议，从而提示困难时刻和支持用户。这种方法获得了令人鼓舞的初步实验结果[43]。经过对参与项目的治疗师进行深入分析和反馈后，决定在实施中调整此功能，改为一个可以在虚拟环境中始终陪伴用户的动画虚拟伴侣，并且可以按需隐藏，或在需要时自动显示。这种方法被开发团队和治疗师认为具有更多优点，原因如下：

对于严重恐惧症的患者，真实治疗师的干预是更为可取的，因为他们具备在患者出现过度反应时进行适当干预的知识，并能根据患者的情绪状态安排暴露疗法。虚拟伴侣对于严重恐惧症患者（在门诊治疗）和轻度恐惧症用户（在家自主治疗）都有效。它提供简单、普遍的建议（提醒一些通用或治疗师选择的放松方法），并在用户需要时提出展示支持要素的建议。虚拟伴侣将产生积极的心理效应，消除一些用户在虚拟环境中感受到的孤立感，必要时转移对恐惧刺激的注意力，并在困难时刻鼓励用户或祝贺他们的成就。虚拟伴侣对于年轻用户而言是一个极具吸引力的概念，他们对这种伴侣类型在视频游戏中非常熟悉。在图21中，我们展示了两个虚拟伴侣——一只老鹰和一只狐狸。

![](images/21.jpg)  
Figure 21. Virtual companions.

当系统检测到一个关键时刻时，用户会收到警报，并有可能打开包含放松辅助元素的菜单（见图22）。在这个菜单中，用户可以找到一系列放松的歌曲和360度的图像或视频。此外，AI生物特征信息监测系统可以在生物特征信息值超过临界阈值一段时间后，自动打开支持面板或甚至终止会话。

![](images/22.jpg)  
Figure 22. Menu with support elements for relaxation.

# 3.6. 虚拟环境的动态适应性

3D环境的动态适应允许逐渐暴露于引发恐惧的元素。这种适应可以由系统自动启动（基于自动性能评估和困难时刻的识别），也可以由治疗师或患者主动进行。恐高症场景具有可以根据患者的恐惧水平进行配置的元素。例如，桥面可以进行修改：用户行走的格栅可以更换为金属面板，这样用户就无法看到下面的情形，或者可以更换为玻璃。金属侧栏可以完全移除，或者更换为更厚的栏杆或不同高度的墙壁。电梯或附加在露台边缘的平台也可以进行类似的修改。在幽闭恐惧症场景中，动态适应包括自动改变场景的照明程度。在场景结束时，根据患者提供的反馈和生物信息的分析，推荐具有适当难度的新场景。

# 3.7. 控制面板

控制面板是PhoVR系统的一个独立应用，用于患者管理和治疗会话控制。该应用的目的是为心理诊所的工作人员提供一个易于使用的界面，以便与PhoVR系统进行交互。它是使用Electron.js平台和HTML5技术开发的。在开发过程中，我们涉及了对象关系映射[44]、管理数据完整性的关系数据库[45]，以及Scrum软件开发方法，因为团队与最终用户之间具有高度的凝聚力和沟通[46]。控制面板提供了一系列基本功能，例如：使用治疗师账户进行管理；患者管理；患者档案配置（包括临床档案）；记录治疗会话并将其保存到云中；显示患者的治疗历史（图23）；以可视化的方式展现治疗会话的结果，并可以添加评论/笔记/评分/患者进展信息（图24）；患者进展的可视化（易于理解的图表）；通过VR设备的实时屏幕分享监控患者的治疗会话，并实时可视化生物特征数据（图25和图26）；会话录音的播放（图27）。

![](images/23.jpg)  
Figure 23. Session history.

![](images/24.jpg)  
Figure 24. Detailed view of a session.

![](images/25.jpg)  
Figure 25. Graphic representation of heart rate data.

治疗师可以访问使用PhoVR系统的患者名单。患者通过控制面板中的患者管理页面添加。对于每位患者，治疗师可以定义和编辑临床概况表。临床概况没有预定义的结构，而是基于一系列简单的条目，带有标题/描述，可以在编辑界面中添加或编辑。因此，该系统为治疗师提供了灵活性，以便按照他们希望或需要的方式构建和生成每位患者的医疗概况。

![](images/26.jpg)  
Figure 26. Graphic representation of electrodermal activity data.

![](images/27.jpg)  
Figure 27. Session playback.

为了监测治疗会话，控制面板具备以下功能：• 实时观看患者在虚拟现实中的视角；• 生物数据和统计信息的可视化；• 观察每个会话级别的任务执行情况；• 仅进行生物数据监测而不使用虚拟环境的特殊会话录制功能（可以观看由治疗师选择，患者在头戴式显示器上查看的视频/图像）。治疗会话通过保存每位患者所执行的信息和动作进行记录。会话的播放可以使用与头戴式显示器相似的桌面应用程序进行。因此，保存的信息用于重现场景和患者在相应会话中执行的动作。为了快速访问和便捷控制可视化，实施了使用时间控制条在录制中不同时间点进行滚动/定位的功能。为了验证技术能力，对控制面板提供的所有功能进行了测试，包括以下特点：通过生成治疗师账户并进行身份认证进行的治疗师账户管理； 通过添加和删除患者的功能进行患者管理； 通过修改患者个人和临床数据的功能进行患者档案配置（包括临床档案）； 通过检查与两个系统（Oculus Quest 2 和连接到 PC 的头戴式显示器）之间的 WebSocket 连接，确保与 PhoVR 硬件设备的正常通信（图 28）； 使用来自 VR 设备的实时视图和实时生物数据可视化监测患者的治疗会话（图 29）；• 录制治疗会话并将其数据保存在云中，可视化患者的会话历史；• 观看治疗会话并添加评论/评分/分数/进度信息的功能； C 显示治疗会话的录制。

![](images/28.jpg)  
Figure 28. HMD connected to a laptop computer.

![](images/29.jpg)  
Figure 29. Monitoring patient therapy sessions—live view from the VR device.

# 4. 测试PhoVR系统

为了使用人类受试者测试系统，我们首先考虑获得伦理批准，以保护研究参与者的权利和安全。由于测试是在布加勒斯特大学生物学院（项目合作方）内进行的，因此伦理批准申请和知情同意书已提交给布加勒斯特大学伦理委员会。参与测试的包括心理治疗师和不同焦虑程度的受试者。测试程序的目的是评估系统在以下几个方面的功能性：• 评估场景的现实程度及其治疗效率；− 评估提供给心理治疗师的设施或患者及治疗会话管理；获得未来系统改进的建议和意见。所有测试都在真实条件下进行，用户仅接受简短培训，随后完全自主地使用原型，类似于实际操作情况。在测试期间，相关用户表现的指标（恐惧反应的掌握程度、公众演讲的质量等）被自动收集。同时，使用后系统原型的效率、可用性、吸引力和人机工程学方面的反馈也被系统地收集。系统的治疗有效性将在一个长期治疗中对患者进展进行定量研究时进行评估。

# 4.1. 测试程序

为了验证用于恐高症和幽闭恐惧症治疗的虚拟现实系统，七位心理治疗师同意参与测试场次。测试在布加勒斯特大学生物系的人类学与动物行为实验室进行。每位测试PhoVR系统的心理治疗师均接受了培训，讲解了系统的功能和模块，包括以下特性：• 患者和治疗会话管理的控制面板；虚拟现实设备的展示以及安装和使用的培训；生物数据采集设备的展示以及使用培训；测试场景的简要介绍；心理治疗专家的测试程序分为三个主要阶段：针对恐高症和幽闭恐惧症治疗的虚拟现实系统测试；公共演讲培训系统的测试；以及系统评估。

最初，每位心理治疗师以患者身份测试系统，以评估治疗场景并学习如何与系统互动（图30）。为此，项目实施团队在整个测试期间提供了支持。在后期阶段，在项目实施团队的指导下，心理治疗师使用该系统对19名不同程度焦虑的受试者进行了测试（4名男性，平均年龄 $= 20.25$ $( + / - 0.96 )$；15名女性，平均年龄 $= 19.86$ $( + / - 0.95 )$），这些受试者未被诊断为恐高症或幽闭恐惧症。招募参与者的排除标准为（1）可能模仿或加重焦虑症状的疾病，如甲状腺疾病、癫痫或创伤性脑损伤，以及（2）目前正在服用可能影响焦虑症状的物质或药物的个体（例如，酒精、苯二氮卓类药物、抗抑郁药或抗精神病药物）。

![](images/30.jpg)  
Figure 30. Psychotherapist testing the system.

每位测试PhoVR系统的参与者都经历了以下步骤： • 填写STAI问卷； • VR设备的介绍； • 生物数据采集设备的介绍； • 短期培训，指导如何在场景中导航并执行所需任务； • 测试场景的简要介绍。 系统功能测试的程序分为三个主要阶段： • 针对恐高症和幽闭恐惧症疗法的VR系统测试； • 针对公众演讲疗法系统的测试； • 通过填写评估问卷进行系统评估。 公众演讲测试环节涉及四名参与者，并在专业治疗师的监督下进行（见图31）。协议内容包括对参与者熟悉的话题进行演讲（例如，脊柱解剖学）。演讲文件在测试环节前一天提供给参与者，以便他们做好准备。

![](images/31.jpg)  
Figure 31. Public speaking testing session.

在会议开始之前，监督心理学家预览了三种可行的（如，社交，和抗拒）设置。根据他们的建议，选择了一个座位占用率平均水平为 $50\%$ 的教室作为共同场景。每位参与者经历了两次曝光会话，会议之间有 10 分钟的休息时间。每次演示的平均持续时间为 5 分钟。在心理学家的建议和支持下，为了识别研究参与者在开始治疗会话时的基线焦虑程度，采用了状态—特质焦虑量表（STAI），这是一种标准化的、经过验证的初始焦虑测试。状态—特质焦虑量表（STAI）是一种评估焦虑作为状态和特质的工具，其涉及焦虑症状的存在、这些症状在此时的严重程度、倾向以及对焦虑的倾向。状态焦虑指的是主观感受，以及个人的状态和感受方式；这是在特定时刻的状态。测量特质焦虑显示个人的总体感受，揭示出在时间上相对稳定的一般方面和特征。最初，STAI 是为研究目的而开发的，用于评估成人的焦虑（涉及精神病、外科和医疗诊所）。STAI 包含 40 项调查问卷，每个子量表（状态和特质）各 20 项，采用 4 点李克特量表评分：1—完全没有，2—有点，3—中等，4—非常多。焦虑评分是通过考虑原始分数和每个量表对应的百分位数来计算的，并参考平均值。高于平均值的分数被视为高分，并指示状态焦虑（S-焦虑）和特质焦虑（T-焦虑）的存在。低于平均值的分数被视为低分，表明没有焦虑。还通过分析测试会话中的生物物理信号记录，额外评估了虚拟环境再现因接触恐惧刺激而引发的压力条件的能力。评估是通过比较训练会话（认为不受恐惧刺激影响）和四个虚拟环境（城市和桥梁（恐高症）以及隧道和迷宫（幽闭恐惧症））期间的电皮肤反应（EDA-T）信号的音调成分和心率（HR）值进行的。在每个测试会话中，使用宽度为 $10 \mathrm s$、步长为 $5 \thinspace s$ 的滑动窗口计算 EDA-T 和 HR 信号的平均值。由于在会话期间，发现用于确定 HR 的 PPG 信号受到参与者运动的强烈影响，因此根据 PPG 信号的质量选择了会话。验证会话的标准是 PPG 信号幅度至少 $90\%$ 的时间大于阈值。阈值是通过目视检查 PPG 信号及其提取的心率，并观察 HR 计算算法正确识别两个脉冲之间间隔的最小幅度来确定的。在分析 PPG 信号的质量后，从记录的 76 次会话中选择了 66 次。进行了单因素方差分析，以比较 EDA-T 和 HR 值作为因变量，环境类型作为自变量。

对于 EDA-T 信号获得的结果为 MTraining $= 8.97$ $( \pm 6.23 )$ $\mu \mathrm{S} ;$ MCity $= 8.53$ $( \pm 6.86 ) \mu S ;$ MBridge $= 11.52$ $( \pm 6.76 )$ $\mu \mathrm{S} ;$ MTunnel $= 11.70 \ ( \pm 6.77 ) \ \mu S ;$ 以及 MLabyrinth $= 8.10$ $( \pm 2.89 ) \mu { S }$ 单因素分析显示这些值之间存在显著差异 $\operatorname { F } ( 5.1871 ) = 16.72 , p < 0.001$ 。随后使用修正后 Bonferroni 方法比较所有虚拟环境的各对。记录到的显著均值差异 (MDs) 包括训练与桥之间 $( \mathrm { M D } = - 2.55 \mu \mathrm { S } , p < 0.001 )$ ，训练与隧道之间 $( \mathrm { M D } = - 2.72 \mu \mathrm { S } , p < 0.001 )$ ，以及城市与桥之间 $( \mathrm { M D } = - 2.99 \mu \mathrm { S } , p < 0.001 )$ ，城市与隧道之间 $( \mathrm { M D } = - 3.17 \mu \mathrm { S } , p < 0.001 )$ ，桥与迷宫之间 $( \mathrm { M D } = + 3.42 \ \mu S ,$ $p = 0.002 ,$ 以及隧道与迷宫之间 $( \mathrm { M D } = + 3.60 ~ \mu S ,$ $p < 0.001$ 。

HR信号的结果为 MTraining $= 83.52$ $(\pm 10.56)$ bpm；MCity $= 85.39$ $(\pm 9.78)$ bpm；MBridge $= 82.73$ $(\pm 9.77)$ bpm；MTunnel $= 82.90$ $(\pm 10.38)$ bpm；和 MLabyrinth $= 83.78$ $(\pm 5.36)$ bpm。单因素分析显示这些值之间存在显著差异 $\operatorname{F}(5.1871) = 4.81$，$p < 0.0001$。采用Bonferroni校正的事后检验用于比较所有虚拟环境的对。这些环境之间显著的均值差异（MDs）被记录，包括训练与城市之间 $(\mathrm{MD} = -1.87 \mathrm{pbm}, p = 0.019)$，以及城市与桥之间 $(\mathrm{MD} = +2.66 \mathrm{pbm}, p = 0.017)$，和城市与隧道之间 $(\mathrm{MD} = +2.49 \mathrm{pbm}, p = 0.002)$。四个虚拟环境中的三个（城市、桥和隧道）被发现具有显著的诱发压力的潜力，这一点得到了高水平的EDA-T和HR的确认。值得注意的是，没有受试者被诊断为恐高症或幽闭恐惧症，这导致他们对虚拟环境中存在的恐惧刺激反应较低。

# 4.2. 结果

在应用STAI问卷后，我们观察到大多数参与者（19名参与者中的16名）在S-焦虑量表（状态焦虑）上得分较高。根据解释说明，S-焦虑量表的得分增加表明在接触被认为是物理上危险的情况和心理压力时可能出现的反应，但经过治疗干预后得分可能会降低。状态焦虑是一种“短暂”的焦虑，可以在实验或日常情况下被触发和诱发。此外，大多数参与者（19名中的16名）在T-焦虑量表（特质焦虑）上得分也较高。该量表测量焦虑的稳定性，即作为特质的焦虑。该量表高分需要更复杂的评估，因为它可能表明抑郁。比较S-焦虑（状态焦虑）和T-焦虑（特质焦虑）的得分，我们得到了以下结果：大多数参与者（16人）同时具有特质焦虑和状态焦虑； 一名T-焦虑量表得分较高（58）的参与者在S-焦虑量表上得分为平均值（40），这可以解读为良好的自我控制； 一名T-焦虑量表得分为平均值（38）的参与者在S-焦虑量表上得分较高（50），这表明某些情况对该个体可能产生强烈的情感影响； 一名参与者在两个量表上均得分为平均值，表明其焦虑水平处于平衡状态。基于这些结果，心理治疗师为每个个体选择了最佳的虚拟治疗场景，并进行了一个虚拟治疗测试会话。在测试结束时，心理学家填写了一份问卷，旨在评估治疗场景的现实感和治疗效率、患者及治疗会话管理提供的设施，并为改进系统提供建议和意见。七名心理治疗师中没有人曾在治疗过程中使用过VR技术。六位在实验后受到启发，并表达了将VR技术偶尔融入当前实践的意愿。七名心理治疗师中有四位表示控制面板提供了患者及暴露会话管理所需的功能，三位表示需要额外的功能。所有七名心理治疗师都认为生物物理数据采集系统对监测患者情感状态的发展是有用的。通过强大的显卡在计算机上生成场景，目前可以实现高度的现实感；然而，系统的成本将显著增加。因此，如果系统由临床中心购买，随后将其提供给多位心理治疗师，这一选项可以被考虑。在会话管理模块方面，心理治疗师提到以下额外功能：每个会话的评论应在患者档案的最后以更集中方式提供；对患者进展的分析；针对不同患者进展的心理学家预配置模块；高级搜索；访问过去的预约。七名心理治疗师中有四位表示VR设备和生物物理数据采集设备并不影响治疗过程，而三位心理治疗师表示对某些患者的治疗程序有阻碍作用。五位心理治疗师认为暴露场景略显不自然，但准确描绘了真实环境，并适合治疗目的。一位心理治疗师指出，恐惧刺激仅对重度恐惧症患者能够引发情感，而另一位心理治疗师表示VR中的恐惧刺激完全无效。一位心理治疗师认为PhoVR系统在治疗恐惧症方面非常有效，而另一位心理治疗师则表示它确实可以提供帮助，但需要改进。其他五位心理治疗师认为该系统对某些特定恐惧病理的患者是有用的。心理治疗师识别出系统的以下弱点： • 可以针对更多恐惧症进行处理； • 对系统的熟悉可能需要一些时间； • 执行某些动作的困难； • VR设备引起的晕眩感。 提出了各种改进建议，包括以下推荐： • 针对多种恐惧症； • 增强现实感； • 左手及可能的身体有更大的活动自由度； • 提供一个更长的虚拟环境和更多分散的任务； • 使用自然环境的真实图像； • 从视觉质量的角度进行改善。 在治疗场景的实施方式方面，心理学家要求在整个治疗过程中保持控制权。进一步发展的建议包括利用其他类型的恐惧症以及增加场景的数量和种类。自动收集的绩效指标和使用后的反馈验证了系统的概念和实用性，表明其吸引力、可用性和人机工程学具有非常高的程度，如上所述。心理治疗师对PhoVR系统在治疗恐高症和幽闭恐惧症方面的测试表示兴趣。在当前实践中，心理治疗师使用成像技术，因为真实环境是提高治疗效率的极为有效的替代方案。在目前这种形式下，由于自主VR设备的技术限制，现实感的水平有限，PhoVR适用于严重恐惧症患者，即使不太现实的恐惧刺激也能引发显著的恐惧反应。大多数心理治疗师表示，在提供其服务的中心内使用PhoVR系统是更可行的选择。给出的理由是，来办公室接受恐高症和幽闭恐惧症治疗的患者人数相对较少，因此不值得购买该系统。如果虚拟现实设备市场的发展导致价格降低（可能伴随性能提高），则个人诊所购买该设备的选项也变得可行。关于治疗场景的实施方式，心理学家要求将场景控制权从自动版本转移到心理治疗师主导的治疗过程。社交恐惧症，包括公众演讲的恐惧，使患者更频繁地寻求治疗，因为这些情境在日常生活中无法避免。在测试后，参与者和心理治疗师均对公众演讲场景的现实性感和治疗会话的有效性给予了积极反馈。同时，使用PhoVR系统的可行性在心理办公室及个别治疗中也进行了分析，尤其是在那些经常需要进行公众演讲的职业人群中。总的来说，系统具有很高的潜力，情绪治疗师对进行治疗会话并在实践中使用系统表现出兴趣。

# 5. 结论

PhoVR 是一个虚拟现实暴露治疗系统，包含针对恐高症的真实沉浸环境（四种场景）、针对幽闭恐惧症的治疗（三个场景），以及针对公众演讲恐惧症的治疗（场景可根据房间大小、观众人数和个性特点进行配置），并融入了丰富的游戏化元素的任务。集成的硬件确保生物物理数据采集（皮肤电活动和心率），并采用专有算法对生理数据进行分类，以确定焦虑水平并识别患者的困难时刻。该系统通过视觉生物反馈、3D环境的动态适应以及虚拟伴侣在困难时刻提供支持。PhoVR 设有一个专门供治疗师管理患者和治疗会话的控制面板，具备自动数据收集和先进分析工具。所有组件整合到一个功能原型中，该原型已用于与恐惧症患者和心理治疗师的评估与验证。治疗师和测试对象对当前的概念和实现反馈非常积极。该原型包含上述所有功能，并具备高程度的人体工程学，能够非常贴合最终商业产品的要求。

根据对各种受试者进行的测试以及心理学家收集的反馈，识别出了一些新的发展机会，以扩展PhoVR系统提供的治疗服务。已确定广场恐惧症和飞行恐惧症为可以通过PhoVR针对的其他类型的恐惧症。治疗师强调的一个重要元素是定制虚拟环境的有效性。在这方面，作为进一步发展的目标，本项目的合作伙伴将研究根据治疗师或患者的描述生成特定于某些恐惧症的虚拟环境的可能性。分析患者表现并跟踪他们的进展是PhoVR系统提供的最重要的功能之一。目前，控制面板提供会话的可视化分析，但这一支持可以通过多个图表和比较分析来改进。为了增加灵活性，我们将研究配置患者仪表板的可能性，包含统计小部件和可以由心理治疗师配置的特定分析。在PhoVR项目内开发的场景可以从实时播放性能的角度进一步优化。在项目中，仅进行了整体场景优化，但在运行场景时，可能会出现因局部复杂性而降低性能的情况。因此，在未来的研究中将考虑对每个局部任务点的场景复杂性进行详细分析。如果局部性能不符合既定标准，将识别解决方案并进行局部更改以解决这些问题。考虑到将PhoVR系统推向面向轻到中等恐惧症的个体用户市场的愿望，目标是降低系统及其配件的购买成本。生物数据测量硬件是购买的一项重大费用。因此，将研究整合一些商业设备（例如健身追踪器）的可能性。

PhoVR致力于治疗各种心理障碍，类似于文献[1115]中描述的商业系统。它还提供放松技巧，类似于C2Care [11]、Amelia [12]和Virtually Better [14]中提供的服务。PhoVR具有患者实时监测、治疗师协调、环境定制和个性化干预，与C2Care [11]、XRHealth [15]和Amelia [12]相似。然而，在PhoVR的情况下，治疗师无法具身观众中的某个人，并作为环境中的对话者与患者交谈，这在C2Care [11]中是可行的。我们将在系统的未来版本中考虑解决这一点。PhoVR允许制定个性化的护理计划，依据患者的进展不断更新，类似于XRHealth [15]。管理面板是PhoVR、C2Care [11]、XRHealth [15]和Amelia [12]的共同特征。来自PhoVR的虚拟伴侣在XRHealth系统[15]中也可以找到，其中Luna作为虚拟伴侣用于疼痛管理和缓解。PhoVR的原创特点包括游戏化任务、教程场景、会话中的情感评估、生物物理数据采集模块和集成于场景元素中的生物反馈。系统的一个局限是基于控制器的移动，这给用户一种安全感或控制感，因为用户手中握着某种物品。此外，基于控制器的导航增加了晕动症并降低了感知的临场感。另一个局限是，在公众演讲恐惧症治疗中，观众只能改变行为，但无法直接与演讲者互动，例如提问、启动对话或回答演讲者提出的问题。此外，虚拟环境中的场景变化较少且较可预测，低于现实世界。因此，需要更广泛的场景和任务库。一个包含随机元素的预先编排场景库可以保持重用内容的不可预测性，可能会提供解决方案，特别是在基于家庭的治疗中，虚拟治疗师可以远程监测进展。本文深入探讨了VR系统的技术方面，并对志愿者和心理治疗师进行了系统测试，以确保其有效性。系统在治疗中的有效性将通过在大量患者（恐惧症患者和对照组）中进行测试，以不同背景的各种治疗师为对象，进行定量评估，以减少其个体经验的影响。研究将延续更长时间，因为治疗是一个需要时间的渐进过程。本次评估的结果将是另一篇文章的重点。作者贡献：概念化，A.M. 和 L.P.；方法论，L.P. 和 C.P.；软件，V.A.；验证，N.J.，A.M.A. 和 O.M.；形式分析，C.P.；调查，N.J.；资源，A.M.；数据整理，C.P.；撰写—原稿准备，O.M.；撰写—审阅和编辑，O.M.；可视化，L.P.；监督，F.M.；项目管理，A.M.；资金获取，A.M. 所有作者均已阅读并同意发表的版本。资金：本工作得到了项目TRAVEE（增强反馈的虚拟治疗师）支持，项目编号PN-III-P2-2.1-PTE-2021-0634，属于PNCDI III。机构审查委员会声明：本研究符合赫尔辛基宣言，并已获得布加勒斯特大学（协议编号28/18.06.2021）的人类研究伦理委员会批准。知情同意声明：所有参与研究的受试者均已获得知情同意。利益冲突声明：作者声明没有利益冲突。

# References

1. UNNewsGloalerspeciveHutorAvailabnline:htts/esn.or/e/ory/022/06/112 acc 15 July 2023).   
2. WorlHealtatioentaDisordevailablnlht/ho.ieoomcthet/etal disorders (accessed on 15 July 2023).   
3. Heal int/publications/i/item/WHO-2019-nCoV-Sci_Brief-Mental_health-2022.1 (accessed on 15 July 2023).   
4. Thao2a0o Tweets, and open research questions. Infect. Dis. Rep. 2022, 14, 855883. [CrossRef]   
5. [CrossRef] [PubMed]   
6. L obishoiaroZvailablenlhteryeico/is-hobs7 (accessed on 15 July 2023).   
7. surprising-facts-about-our-biggest-fears/ (accessed on 15 July 2023).   
8. 2021, 19, 184189. [CrossRef] [PubMed]   
9. l   
10. H   o rlraeeour heee ahoim 99515, 62 osRe [M]   
11. C2Care. Available online: https:/ /www.c2.care/en/ (accessed on 15 July 2023).   
12. Amelia. Available online: https:/ / ameliavirtualcare.com (accessed on 15 July 2023).   
13. Virtual Reality Medical Center. Available online: https:/ /vrphobia.com/ (accessed on 15 July 2023).   
14.Virtually Better. Available online: https:/ /www.virtuallybetter.com/ (accessed on 15 July 2023).   
15. XRHealth. Available online: https:/ /www.xr.health/ (accessed on 15 July 2023).   
16. UK, 1011 November 2015.   
17. CM.C l PsychNology J. 2008, 6, 203.   
18. M.. AM. M. A.. uiaB.0   
19. 162167. [CrossRef]   
20. Ge [PubMed]   
21. Los Angeles, CA, USA, 2022 September 2016; pp. 149155.   
22. VH   
23. Telecare 2016, 22, 215220. [CrossRef] [PubMed]   
24. l Germany, 1822 March 2018.   
25. . Cyberpsychol. Behav. 2006, 9, 627633. [CrossRef] [PubMed]   
81, 372378. [PubMed]   
27. DIVE. Available online: https:/ /www.ri.se/sv?refdom $\equiv$ sics.se (accessed on 9 September 2023).   
Real. Multimed. Publ. Prof. 1998, 3, 318320. [CrossRef]   
29. Stupar-Rutenfrans, S.; Ketelaars, L.E.H.; van Gisbergen, M.S. Beat the fear of public speaking: Mobile $3 6 0 ^ { \circ }$ video virtual reality [CrossRef] [PubMed]   
30. ..   .R. engineers using virtual reality exposure therapy. Commun. Comput. Inf. Sci. 2017, 191202. [CrossRef]   
31. H the 2016 HI Conference Extende Abstract on Human Factors inComputing Sstems, San Jose, CA, USA, 712Ma 2016; ACM: New York, NY, USA.   
32. , Xi'an, China, 1013 June 2019.   
33. Oculus Quest 2. Available online: https:/ /www.oculus.com/experiences/quest/ (accessed on 15 July 2023).   
34. HTC Vive. Available online: https:/ /www.vive.com/us/ (accessed on 15 July 2023).   
35. Valve Index. Available online: https:/ /www.valvesoftware.com/ro/index (accessed on 15 July 2023).   
3BTalino.Available online:https://www.pluxbiosignals.com/collections/bitalino (accesse on15 July203).   
37. Microsoft Azure. Available online: https:/ /azure.microsoft.com/ (accessed on 15 July 2023).   
38. Unity 3D. Available online: https:/ /unity.com/ (accessed on 15 July 2023).   
39. Sui./o/lu (accessed on 15 July 2023).   
40. Adobe Fuse. Available online: https:/ /www.adobe.com/wam/fuse.html (accessed on 15 July 2023).   
41. Adobe Mixamo. Available online: https:/ /www.mixamo.com/#/ (accessed on 15 July 2023).   
42. text (accessed on 15 July 2023).   
43. o — l C Augmented Reality, Copenhagen, Denmark, 1924 July 2020; pp. 1225.   
44. International Conference on Control Systems and Computer Science (CS), Bucharest, Romania, 2628 May 2021.   
45. s e 2022), Denarau Island, Fiji, 810 December 2022; Publisher Springer Nature: Singapore, 2022; pp. 275288.   
46. Ae I.ICa R.S.NeeM.La I.C.TC.BC.A.ve comparative analysis. UPB Sci. Bull. 2022, 83, 3.   
47. JA depression scale-anxiety (HADS-A). Arthritis Care Res. 2011, 63, 467472. [CrossRef]   
48. G GRJH.C.LS C.e lateralization of EEG during a stressful movie. Psychophysiology 1989, 26, 311320. [CrossRef] [PubMed]   
49. A Ivey (orapte or leuls. Rv.CanViean.9 17403.